diff --git a/src/js/redirect-engine.js b/src/js/redirect-engine.js
index 9368c812..024e2812 100644
--- a/src/js/redirect-engine.js
+++ b/src/js/redirect-engine.js
@@ -168,6 +168,9 @@ const extToMimeMap = new Map([
     [  'txt', 'text/plain' ],
 ]);
 
+nano.insert_redirect_declaration(redirectableResources);
+nano.insert_mime_declaration(extToMimeMap);
+
 const validMimes = new Set(extToMimeMap.values());
 
 const mimeFromName = function(name) {
diff --git a/src/js/scriptlet-filtering.js b/src/js/scriptlet-filtering.js
index b1cd5141..5b5d606f 100644
--- a/src/js/scriptlet-filtering.js
+++ b/src/js/scriptlet-filtering.js
@@ -223,7 +223,7 @@
             }
             content =
                 'try {\n' +
-                    content + '\n' +
+                    content.replace('{{nano}}', '') + '\n' +
                 '} catch ( e ) { }';
             scriptletCache.add(rawToken, content);
         }
@@ -287,6 +287,14 @@
             return;
         }
 
+        var nanoInjectArgs = parsed.suffix.slice(4, -1);
+        if (
+            !nano.cf.is_privileged &&
+            nanoInjectArgs.startsWith(nano.privileged_assets_previx)
+        ) {
+            return;
+        }
+
         // https://github.com/gorhill/uBlock/issues/3375
         //   Ignore instances of exception filter with negated hostnames,
         //   because there is no way to create an exception to an exception.
